# 🔧 测试账号密码修复说明

## 问题描述
用户在测试API接口时遇到"密码不符合规则"的错误。经过检查发现，系统要求密码**至少8位字符**，但之前提供的测试密码只有6位。此外，部分测试账号不存在或密码不正确的问题也已修复。

## 修复内容

### ✅ 系统密码要求
- **最小长度**: 8位字符
- **验证规则**: 在 `backend-api/src/utils/validation.ts` 中定义
- **后端路由验证**: 已统一修复 `backend-api/src/routes/admin.ts` 中不一致的验证规则

### ✅ 修复后的测试账号

#### 1. 普通用户账号
- **邮箱**: `user@aiinterview.com`
- **密码**: `12345678` ✅ (8位，符合要求)
- **姓名**: 测试用户
- **角色**: 普通用户
- **状态**: 已激活、已验证

#### 2. 演示用户账号
- **邮箱**: `demo@test.com`
- **密码**: `password123` ✅ (11位，符合要求)
- **姓名**: 演示用户
- **角色**: 普通用户
- **状态**: 已激活、已验证

#### 3. 企业账号
- **邮箱**: `hr@techcorp.com`
- **密码**: `12345678` ✅ (8位，符合要求)
- **企业名**: 科技有限公司
- **状态**: 已验证，已激活

#### 4. 管理员账号
- **邮箱**: `admin@ai-interview.com`
- **密码**: `admin123456` ✅ (12位，符合要求)
- **姓名**: 系统管理员
- **角色**: 超级管理员
- **状态**: 已激活

## 重要修复记录

### 🔧 修复的问题
1. **密码验证规则不一致**: 统一所有密码验证为最少8位字符
2. **测试用户不存在**: 重新创建 `test@example.com` 和 `demo@test.com` 用户
3. **密码不正确**: 修复所有账号的密码哈希
4. **数据冲突**: 清理旧的测试数据，避免唯一约束冲突

## 更新的文件

### 1. 密码验证规则修复
- ✅ `backend-api/src/routes/admin.ts` - 修复密码验证规则不一致问题
- ✅ `backend-api/src/utils/validation.ts` - 确认密码最小长度为8位

### 2. 测试数据修复
- ✅ `backend-api/fix_test_users.js` - 新建用户数据修复脚本
- ✅ 清理冲突的测试数据
- ✅ 重新创建正确的测试用户

### 3. API文档配置
- ✅ `backend-api/src/config/swagger.ts` - 更新测试账号密码
- ✅ `backend-api/src/routes/auth.ts` - 更新所有示例密码

### 4. 数据库种子文件
- ✅ `backend-api/src/utils/seedTestData.ts` - 更新企业密码
- ✅ `backend-api/src/utils/createTestUser.ts` - 已有正确密码

## 测试验证

### 方法一：使用测试令牌生成器 (推荐)
1. 访问: http://localhost:3001/api/docs
2. 找到 **🧪 测试工具** → `POST /api/auth/test-token`
3. 选择用户类型并执行
4. 复制token并设置认证
5. 测试各个接口

### 方法二：真实登录测试
1. 使用 `POST /api/auth/login/user`
2. 请求体:
   ```json
   {
     "email": "user@aiinterview.com",
     "password": "12345678"
   }
   ```
3. 获取JWT令牌并设置认证

## 注意事项

### ⚠️ 密码要求
- 所有新注册用户密码必须**至少8位**
- 现有文档和示例已全部更新
- 旧的6位密码将无法通过验证

### ✅ 测试建议
1. 优先使用测试令牌生成器（无需真实登录）
2. 测试完整的AI面试流程
3. 验证所有需要认证的接口

## 完成状态

- [x] 修复密码验证规则问题
- [x] 更新所有API文档示例
- [x] 更新数据库种子数据
- [x] 重新生成企业测试账号
- [x] 验证用户测试账号
- [x] 更新使用说明文档

**🎉 现在可以正常使用所有测试账号进行API测试了！** 