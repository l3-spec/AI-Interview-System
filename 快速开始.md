# 🚀 数字人沟通测试 - 快速开始

## 一、快速测试（3 步完成）

```bash
# 步骤 1: 检查配置
./check-digital-human-config.sh

# 步骤 2: 启动系统
./start-digital-human-test.sh

# 步骤 3: 打开浏览器
# 访问: http://localhost:3001/test/digital-human
```

## 二、必需配置

在 `backend-api/.env` 文件中配置以下内容：

### 最小配置（必需）

```bash
# DeepSeek API (必需)
DEEPSEEK_API_KEY=sk-xxxxxxxxxxxxxxxx

# ASR 服务（选择一个）
VOLC_APP_ID=xxxxxxxx
VOLC_ACCESS_KEY=xxxxxxxx
VOLC_SECRET_KEY=xxxxxxxx

# TTS 服务（选择一个）
ALIYUN_ACCESS_KEY_ID=xxxxxxxx
ALIYUN_ACCESS_KEY_SECRET=xxxxxxxx
ALIYUN_TTS_APP_KEY=xxxxxxxx
```

## 三、Web 测试步骤

1. **连接服务器**
   - 点击"🔌 连接服务"按钮
   - 等待状态变为"已连接"

2. **开始录音**
   - 点击"🎤 开始录音"按钮
   - 说话（例如："你好，我想应聘软件工程师"）
   - 点击"⏹️ 停止录音"

3. **等待回复**
   - 系统自动进行：语音识别 → AI生成 → 语音合成
   - 数字人会自动播放回复

## 四、Android 测试步骤

### 1. 配置 IP 地址

编辑 `android-v0-compose/app/src/main/java/com/xlwl/AiMian/config/AppConfig.kt`:

```kotlin
object AppConfig {
    // 替换为你的电脑 IP
    const val realtimeVoiceWsUrl = "ws://192.168.1.100:3001"
}
```

查看本机 IP:
```bash
# Mac/Linux
ifconfig | grep "inet " | grep -v 127.0.0.1

# 或者
./start-digital-human-test.sh  # 启动脚本会显示 IP
```

### 2. 安装应用

```bash
cd android-v0-compose
./gradlew assembleDebug
adb install -r app/build/outputs/apk/debug/app-debug.apk
```

### 3. 测试

1. 打开应用，进入"数字人面试"
2. 授予麦克风和摄像头权限
3. 等待"连接成功"提示
4. 点击"开始答题"并说话
5. 数字人会自动回复

## 五、测试示例对话

### 第一轮
- **你**: "你好，我想应聘软件工程师"
- **数字人**: "你好！很高兴认识你。请先做一个简单的自我介绍吧。"

### 第二轮
- **你**: "我叫张三，有5年Java开发经验"
- **数字人**: "很好！能具体说说你最近参与的项目吗？"

### 第三轮
- **你**: "我参与了电商平台的后端开发"
- **数字人**: "听起来很有经验。请问你在项目中负责哪些模块？"

## 六、常见问题快速解决

### ❌ 连接失败
```bash
# 检查后端是否运行
lsof -i :3001

# 重启服务
./start-digital-human-test.sh
```

### ❌ 语音识别失败
```bash
# 检查 ASR 配置
source backend-api/.env
echo $VOLC_APP_ID
```

### ❌ 数字人不回复
```bash
# 检查 DeepSeek API
source backend-api/.env
echo $DEEPSEEK_API_KEY

# 查看日志
tail -f backend-api/digital-human-backend.log
```

### ❌ Android 无法连接
```bash
# 1. 确保手机和电脑在同一 WiFi
# 2. 使用电脑 IP（不是 localhost）
# 3. 检查防火墙设置
```

## 七、查看日志

```bash
# 后端日志
tail -f backend-api/digital-human-backend.log

# 前端日志
tail -f admin-dashboard/digital-human-dashboard.log

# Android 日志
adb logcat | grep "RealtimeVoiceManager"
```

## 八、停止服务

```bash
# 方法 1: 按 Ctrl+C（如果在前台运行）

# 方法 2: 运行停止脚本
./stop-digital-human-test.sh

# 方法 3: 手动停止
kill $(lsof -ti:3001)
kill $(lsof -ti:5173)
```

## 九、访问地址

启动成功后，可以访问：

- 🌐 **Web 测试页面**: http://localhost:3001/test/digital-human
- 📊 **Admin Dashboard**: http://localhost:5173
- 🔌 **WebSocket 端点**: ws://localhost:3001
- 📖 **API 文档**: http://localhost:3001/api-docs

## 十、获取帮助

### 详细文档
📖 查看《数字人沟通测试完整指南.md》

### 系统架构
📖 查看《数字人开源方案调研报告.md》

### 配置检查
```bash
./check-digital-human-config.sh
```

---

## 🎉 快速开始总结

```bash
# 1️⃣ 配置环境变量
vi backend-api/.env

# 2️⃣ 检查配置
./check-digital-human-config.sh

# 3️⃣ 启动系统
./start-digital-human-test.sh

# 4️⃣ 打开浏览器测试
# http://localhost:3001/test/digital-human
```

**就这么简单！开始你的数字人沟通测试吧！** 🚀

