# DigitalInterviewScreen é›†æˆå®æ—¶è¯­éŸ³ç¤ºä¾‹

## ğŸ“ é›†æˆæ­¥éª¤

### 1. åœ¨DigitalInterviewScreenä¸­é›†æˆRealtimeVoiceManager

```kotlin
// android-v0-compose/app/src/main/java/com/example/v0clone/ai/DigitalInterviewScreen.kt

// åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ å¯¼å…¥
import com.xlwl.AiMian.ai.realtime.RealtimeVoiceManager
import kotlinx.coroutines.launch

@Composable
fun DigitalInterviewScreen(
    uiState: DigitalInterviewUiState,
    onBackClick: () -> Unit,
    onStartAnswer: () -> Unit,
    onRetry: () -> Unit
) {
    val context = LocalContext.current
    val live2DController = remember { Live2DViewController() }
    
    // åˆ›å»ºå®æ—¶è¯­éŸ³ç®¡ç†å™¨
    val voiceManager = remember { RealtimeVoiceManager(context) }
    
    // åˆå§‹åŒ–WebSocketè¿æ¥
    LaunchedEffect(uiState.sessionId) {
        uiState.sessionId?.let { sessionId ->
            val serverUrl = "http://your-server:3001" // æ›¿æ¢ä¸ºæ‚¨çš„æœåŠ¡å™¨åœ°å€
            
            val connected = voiceManager.initialize(serverUrl, sessionId)
            if (connected) {
                voiceManager.setLive2DController(live2DController)
                Log.d("DigitalInterviewScreen", "å®æ—¶è¯­éŸ³æœåŠ¡å·²è¿æ¥")
            } else {
                Log.e("DigitalInterviewScreen", "å®æ—¶è¯­éŸ³æœåŠ¡è¿æ¥å¤±è´¥")
            }
        }
    }
    
    // æ§åˆ¶å½•éŸ³
    LaunchedEffect(uiState.isRecording) {
        if (uiState.isRecording) {
            voiceManager.startRecording()
        } else {
            voiceManager.stopRecording()
        }
    }
    
    // æ¸…ç†èµ„æº
    DisposableEffect(Unit) {
        onDispose {
            voiceManager.cleanup()
        }
    }
    
    // æ‚¨çš„ç°æœ‰UIä»£ç ...
    Box(modifier = Modifier.fillMaxSize()) {
        // Live2Dè§†å›¾
        Live2DView(
            controller = live2DController,
            modifier = Modifier
                .size(200.dp)
                .align(Alignment.TopEnd)
        )
        
        // å…¶ä»–UIç»„ä»¶...
    }
}
```

### 2. æ·»åŠ æƒé™ï¼ˆAndroidManifest.xmlï¼‰

```xml
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.INTERNET" />
```

### 3. æ·»åŠ ä¾èµ–ï¼ˆbuild.gradle.ktsï¼‰

```kotlin
dependencies {
    // Socket.IOå®¢æˆ·ç«¯
    implementation("io.socket:socket.io-client:2.0.1")
    
    // å…¶ä»–ç°æœ‰ä¾èµ–...
}
```

---

## ğŸ¯ å®Œæ•´æµç¨‹

1. **ç”¨æˆ·å¼€å§‹é¢è¯•** â†’ åˆ›å»ºä¼šè¯ID
2. **åˆå§‹åŒ–WebSocket** â†’ è¿æ¥åˆ°åç«¯
3. **ç”¨æˆ·è¯´è¯** â†’ å½•éŸ³å¹¶å‘é€éŸ³é¢‘æ•°æ®
4. **åç«¯å¤„ç†** â†’ ASRè¯†åˆ« â†’ LLMç”Ÿæˆå›å¤ â†’ TTSåˆæˆ
5. **è¿”å›éŸ³é¢‘** â†’ Androidæ’­æ”¾éŸ³é¢‘
6. **é©±åŠ¨Live2D** â†’ å®æ—¶åˆ†æéŸ³é¢‘é©±åŠ¨å˜´å‹

---

## ğŸ”§ é…ç½®è¯´æ˜

### åç«¯é…ç½®

åœ¨ `backend-api/.env` ä¸­é…ç½®ï¼š

```bash
# RTCæœåŠ¡ï¼ˆé€‰æ‹©ä¸€ç§ï¼‰
RTC_PROVIDER=volcengine
RTC_APP_ID=your_app_id
RTC_APP_KEY=your_app_key
RTC_REGION=cn-north-1

# æˆ–ä½¿ç”¨å£°ç½‘
# RTC_PROVIDER=agora
# RTC_APP_ID=your_app_id
# RTC_APP_KEY=your_app_key
# RTC_TOKEN=your_token
```

### Androidé…ç½®

åœ¨ `DigitalInterviewScreen` ä¸­è®¾ç½®æœåŠ¡å™¨åœ°å€ï¼š

```kotlin
val serverUrl = "http://192.168.1.100:3001" // å±€åŸŸç½‘åœ°å€
// æˆ–
val serverUrl = "https://your-domain.com" // ç”Ÿäº§ç¯å¢ƒåœ°å€
```

---

## âœ… æµ‹è¯•æ£€æŸ¥æ¸…å•

- [ ] åç«¯æœåŠ¡å·²å¯åŠ¨
- [ ] WebSocketè¿æ¥æˆåŠŸ
- [ ] éŸ³é¢‘æƒé™å·²æˆäºˆ
- [ ] å½•éŸ³åŠŸèƒ½æ­£å¸¸
- [ ] éŸ³é¢‘å‘é€æˆåŠŸ
- [ ] æ”¶åˆ°è¯­éŸ³å“åº”
- [ ] éŸ³é¢‘æ’­æ”¾æ­£å¸¸
- [ ] Live2Då˜´å‹æ›´æ–°

---

**ä»£ç å·²å…¨éƒ¨å®ç°å®Œæˆï¼** ğŸ‰

