<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fayæ•°å­—äººé¢è¯•ç³»ç»Ÿ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .header {
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .container {
            flex: 1;
            display: flex;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            gap: 20px;
        }
        
        .digital-human {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .control-panel {
            width: 350px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .fay-display {
            width: 100%;
            height: 400px;
            background: #000;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }
        
        .fay-avatar {
            width: 200px;
            height: 200px;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .character-selector {
            margin-bottom: 20px;
        }
        
        .character-selector select {
            width: 100%;
            padding: 10px;
            border-radius: 10px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 16px;
        }
        
        .chat-area {
            height: 200px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            overflow-y: auto;
            margin-bottom: 15px;
            color: white;
        }
        
        .input-area {
            display: flex;
            gap: 10px;
        }
        
        .input-area input {
            flex: 1;
            padding: 10px;
            border-radius: 10px;
            border: none;
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }
        
        .input-area button {
            padding: 10px 20px;
            border-radius: 10px;
            border: none;
            background: #4ecdc4;
            color: white;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .input-area button:hover {
            background: #45b7b8;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        .status-connected {
            background: #4ecdc4;
        }
        
        .status-disconnected {
            background: #ff6b6b;
        }
        
        .voice-controls {
            margin-top: 20px;
            text-align: center;
        }
        
        .voice-btn {
            padding: 15px 30px;
            margin: 5px;
            border-radius: 25px;
            border: none;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.3s;
        }
        
        .voice-btn:hover {
            transform: translateY(-2px);
        }
        
        .voice-btn:active {
            transform: translateY(0);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ­ Fayæ•°å­—äººé¢è¯•ç³»ç»Ÿ</h1>
        <p>AIé©±åŠ¨çš„å®æ—¶æ•°å­—äººé¢è¯•ä½“éªŒ</p>
        <div>
            <span class="status-indicator" id="connection-status"></span>
            <span id="connection-text">è¿æ¥ä¸­...</span>
        </div>
    </div>
    
    <div class="container">
        <div class="digital-human">
            <h2>æ•°å­—äººå±•ç¤º</h2>
            <div class="fay-display">
                <div class="fay-avatar" id="fay-avatar">ğŸ¤–</div>
            </div>
            
            <div class="character-selector">
                <label>é€‰æ‹©è§’è‰²ï¼š</label>
                <select id="character-select">
                    <option value="tech_interviewer">æŠ€æœ¯é¢è¯•å®˜</option>
                    <option value="hr_interviewer">HRé¢è¯•å®˜</option>
                    <option value="pressure_interviewer">å‹åŠ›é¢è¯•å®˜</option>
                </select>
            </div>
            
            <div class="voice-controls">
                <button class="voice-btn" onclick="startInterview()">å¼€å§‹é¢è¯•</button>
                <button class="voice-btn" onclick="testVoice()">æµ‹è¯•è¯­éŸ³</button>
            </div>
        </div>
        
        <div class="control-panel">
            <h3>å®æ—¶å¯¹è¯</h3>
            <div class="chat-area" id="chat-area">
                <div>ç­‰å¾…è¿æ¥...</div>
            </div>
            
            <div class="input-area">
                <input type="text" id="question-input" placeholder="è¾“å…¥é¢è¯•é—®é¢˜..." />
                <button onclick="sendQuestion()">å‘é€</button>
            </div>
            
            <div style="margin-top: 20px;">
                <h4>å¿«é€Ÿæµ‹è¯•</h4>
                <button class="voice-btn" onclick="quickTest('è‡ªæˆ‘ä»‹ç»')">è‡ªæˆ‘ä»‹ç»</button>
                <button class="voice-btn" onclick="quickTest('æŠ€æœ¯æ ˆ')">æŠ€æœ¯é—®é¢˜</button>
                <button class="voice-btn" onclick="quickTest('èŒä¸šè§„åˆ’')">èŒä¸šè§„åˆ’</button>
            </div>
        </div>
    </div>

    <script>
        let socket;
        let currentCharacter = 'tech_interviewer';
        
        // åˆå§‹åŒ–è¿æ¥
        function initConnection() {
            socket = io('ws://localhost:3001');
            
            socket.on('connect', () => {
                updateConnectionStatus(true);
                addMessage('ç³»ç»Ÿ', 'å·²è¿æ¥åˆ°Fayæ•°å­—äººç³»ç»Ÿ');
                socket.emit('join_interview', {userId: 'demo_user'});
            });
            
            socket.on('disconnect', () => {
                updateConnectionStatus(false);
                addMessage('ç³»ç»Ÿ', 'è¿æ¥å·²æ–­å¼€');
            });
            
            socket.on('interview_response', (data) => {
                addMessage('Fay', data.response);
                animateAvatar();
            });
            
            socket.on('voice_ready', (data) => {
                addMessage('ç³»ç»Ÿ', 'è¯­éŸ³åˆæˆå®Œæˆ');
                playAudio(data.audioUrl);
            });
            
            socket.on('user_joined', (data) => {
                addMessage('ç³»ç»Ÿ', 'æ–°ç”¨æˆ·åŠ å…¥é¢è¯•');
            });
        }
        
        function updateConnectionStatus(connected) {
            const status = document.getElementById('connection-status');
            const text = document.getElementById('connection-text');
            
            if (connected) {
                status.className = 'status-indicator status-connected';
                text.textContent = 'å·²è¿æ¥';
            } else {
                status.className = 'status-indicator status-disconnected';
                text.textContent = 'æœªè¿æ¥';
            }
        }
        
        function addMessage(sender, message) {
            const chatArea = document.getElementById('chat-area');
            const messageDiv = document.createElement('div');
            messageDiv.innerHTML = `<strong>${sender}:</strong> ${message}<br>`;
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }
        
        function animateAvatar() {
            const avatar = document.getElementById('fay-avatar');
            avatar.style.animation = 'none';
            setTimeout(() => {
                avatar.style.animation = 'pulse 2s infinite';
            }, 100);
        }
        
        function sendQuestion() {
            const input = document.getElementById('question-input');
            const question = input.value.trim();
            
            if (question && socket.connected) {
                addMessage('ä½ ', question);
                socket.emit('send_question', {
                    question: question,
                    character: currentCharacter
                });
                input.value = '';
            }
        }
        
        function startInterview() {
            if (socket.connected) {
                currentCharacter = document.getElementById('character-select').value;
                socket.emit('start_session', {
                    character: currentCharacter,
                    questions: [
                        'è¯·è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹',
                        'ä½ ä¸ºä»€ä¹ˆæƒ³åŠ å…¥æˆ‘ä»¬å…¬å¸',
                        'ä½ çš„æœ€å¤§ä¼˜åŠ¿æ˜¯ä»€ä¹ˆ'
                    ]
                });
                addMessage('ç³»ç»Ÿ', `å¼€å§‹${currentCharacter}é¢è¯•æ¨¡å¼`);
            }
        }
        
        function testVoice() {
            if (socket.connected) {
                socket.emit('voice_synthesis', {
                    text: 'ä½ å¥½ï¼Œæˆ‘æ˜¯AIé¢è¯•å®˜ï¼Œå¾ˆé«˜å…´è§åˆ°ä½ ï¼',
                    voice: 'zh-CN-XiaoxiaoNeural'
                });
            }
        }
        
        function quickTest(type) {
            const questions = {
                'è‡ªæˆ‘ä»‹ç»': 'è¯·ç®€å•è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹',
                'æŠ€æœ¯æ ˆ': 'è¯·ä»‹ç»ä¸€ä¸‹ä½ çš„æŠ€æœ¯æ ˆ',
                'èŒä¸šè§„åˆ’': 'ä½ æœªæ¥3å¹´çš„èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆ'
            };
            
            if (questions[type]) {
                document.getElementById('question-input').value = questions[type];
                sendQuestion();
            }
        }
        
        function playAudio(url) {
            if (url) {
                const audio = new Audio(url);
                audio.play().catch(e => console.log('éŸ³é¢‘æ’­æ”¾å¤±è´¥:', e));
            }
        }
        
        // é”®ç›˜äº‹ä»¶
        document.getElementById('question-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendQuestion();
            }
        });
        
        // åˆå§‹åŒ–
        initConnection();
    </script>
</body>
</html>