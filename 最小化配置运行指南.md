# 🚀 最小化配置运行指南

> 不需要语音识别（ASR），只用文本输入和语音输出

---

## 🎯 适用场景

如果你只想测试以下功能：
- ✅ **文本对话** - 用键盘输入问题
- ✅ **语音回复** - 数字人用语音回答
- ✅ **Live2D 动画** - 数字人口型同步
- ❌ ~~语音输入~~ - 暂不支持说话输入

**那么你不需要配置 ASR 服务！**

---

## 📋 最小化配置清单

### 只需要 2 个服务：

1. **DeepSeek AI**（必需）- 智能对话生成
2. **阿里云 TTS**（必需）- 语音合成

**不需要**：
- ❌ 火山引擎 ASR（语音识别）
- ❌ 声网 ASR（语音识别）

---

## 📝 最小配置文件

在 `backend-api/.env` 中只需配置：

```bash
# ============================================================================
# 最小化配置 - 仅支持文本输入
# ============================================================================

# DeepSeek AI（必需）
DEEPSEEK_API_KEY="<your-deepseek-api-key>"
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_MODEL=deepseek-chat

# 阿里云 TTS（必需）
ALIYUN_TTS_ACCESS_KEY_ID=LTAI5txxxxxxxxxxxxxxxxxx
ALIYUN_TTS_ACCESS_KEY_SECRET=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
ALIYUN_TTS_VOICE=siqi
ALIYUN_TTS_FORMAT=mp3
ALIYUN_TTS_SAMPLE_RATE=16000

# 其他配置
NODE_ENV=development
PORT=3001
TTS_PROVIDER=aliyun
```

---

## ✅ 启动系统

配置好后直接启动：

```bash
# 1. 检查配置（会有 ASR 警告，忽略即可）
./check-digital-human-config.sh

# 2. 启动系统
./start-digital-human-test.sh

# 3. 打开浏览器
# 访问: http://localhost:3001/test/digital-human
```

你会看到这样的提示：
```
⚠ ASR 服务: 未配置 ASR 服务（仅文本输入可用，语音输入不可用）
✓ TTS 服务: 已配置阿里云 TTS
✓ 系统可以正常运行！
```

---

## 🧪 测试方式

### Web 端测试（修改版）

由于没有 ASR，Web 测试页面的录音功能不可用，但你可以：

#### 方式一：使用文本 API 测试

```bash
# 发送文本消息测试
curl -X POST http://localhost:3001/api/digital-human/chat \
  -H "Content-Type: application/json" \
  -d '{
    "sessionId": "test-123",
    "text": "你好，我想应聘软件工程师",
    "userId": "test-user",
    "jobPosition": "软件工程师"
  }'
```

返回：
```json
{
  "success": true,
  "audioUrl": "http://localhost:3001/uploads/audio/xxxxx.mp3",
  "text": "你好！很高兴认识你。请先做一个简单的自我介绍吧。",
  "sessionId": "test-123"
}
```

#### 方式二：创建简化版测试页面

我可以为你创建一个只用文本输入的测试页面。

---

## 📱 Android 端使用

Android 应用中，如果没有 ASR：

### 修改 1：禁用录音按钮

```kotlin
// DigitalInterviewScreen.kt
val buttonText = when {
    connectionState != ConnectionState.CONNECTED -> "连接语音服务中…"
    isProcessing -> "数字人应答中…"
    // isRecording -> "结束回答"  // 注释掉录音模式
    else -> "发送文本消息"  // 改为文本模式
}
```

### 修改 2：使用文本输入

```kotlin
// 添加文本输入框
var userInput by remember { mutableStateOf("") }

TextField(
    value = userInput,
    onValueChange = { userInput = it },
    placeholder = { Text("输入你的回答...") },
    modifier = Modifier.fillMaxWidth()
)

Button(
    onClick = {
        if (userInput.isNotBlank()) {
            voiceManager.sendTextMessage(userInput)
            userInput = ""
        }
    }
) {
    Text("发送")
}
```

---

## 💰 费用对比

### 完整配置（带 ASR）

```
DeepSeek: ¥0.001/1K tokens
ASR: ¥0.02/分钟
TTS: ¥0.00125/字符
────────────────────────
每次对话: ~¥0.05
```

### 最小配置（无 ASR）

```
DeepSeek: ¥0.001/1K tokens
TTS: ¥0.00125/字符
────────────────────────
每次对话: ~¥0.03
```

**省 40% 费用！**

---

## 🔄 升级到完整版

如果以后想添加语音输入功能：

### 1. 开通 ASR 服务

选择一个：
- 火山引擎 ASR: https://console.volcengine.com/speech
- 声网 ASR: https://console.agora.io/

### 2. 添加配置

```bash
# 在 .env 中添加
VOLC_APP_ID=你的AppID
VOLC_ACCESS_KEY=你的AccessKey
VOLC_SECRET_KEY=你的SecretKey
```

### 3. 重启系统

```bash
./start-digital-human-test.sh
```

---

## 🎯 功能对比表

| 功能 | 最小配置 | 完整配置 |
|------|---------|---------|
| 文本输入对话 | ✅ | ✅ |
| 语音输入对话 | ❌ | ✅ |
| 数字人语音回复 | ✅ | ✅ |
| Live2D 口型同步 | ✅ | ✅ |
| 打断机制 | ❌ | ✅ |
| Web 录音测试 | ❌ | ✅ |
| Android 录音 | ❌ | ✅ |

---

## 📖 适用场景建议

### 适合最小配置的场景：

- ✅ 快速原型验证
- ✅ 演示数字人回复效果
- ✅ 测试 LLM 对话逻辑
- ✅ 开发前期调试
- ✅ 节省开发成本

### 需要完整配置的场景：

- ❌ 真实面试场景
- ❌ 需要语音交互
- ❌ 需要打断功能
- ❌ 生产环境部署

---

## 🛠️ 创建文本输入测试页面

我可以为你创建一个简化的测试页面，支持：
- 📝 文本输入框
- 🔊 语音播放
- 💬 对话记录
- 🎭 Live2D 数字人（Android）

需要吗？

---

## 💡 总结

**核心配置**（2个）：
```bash
✓ DEEPSEEK_API_KEY=xxx
✓ ALIYUN_TTS_ACCESS_KEY_ID=xxx
✓ ALIYUN_TTS_ACCESS_KEY_SECRET=xxx
```

**可选配置**（语音输入需要）：
```bash
○ VOLC_APP_ID=xxx
○ VOLC_ACCESS_KEY=xxx
○ VOLC_SECRET_KEY=xxx
```

**现在就可以启动系统了！** 🚀

```bash
./start-digital-human-test.sh
```

---

## ❓ 常见问题

### Q: 没有 ASR 能测试吗？
**A**: 可以！使用文本输入或 API 调用测试。

### Q: 以后能加 ASR 吗？
**A**: 可以！随时添加配置即可，无需改代码。

### Q: Android 应用能用吗？
**A**: 能用，但需要修改成文本输入模式。

### Q: 费用会便宜吗？
**A**: 会！省去 ASR 费用，约便宜 40%。

---

**配置好 DeepSeek 和 TTS 就可以开始测试了！** 🎉

